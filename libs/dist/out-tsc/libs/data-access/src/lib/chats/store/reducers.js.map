{"version":3,"file":"reducers.js","sourceRoot":"","sources":["../../../../../../../../data-access/src/lib/chats/store/reducers.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,EAAE,EAAE,MAAM,aAAa,CAAC;AAChD,OAAO,EAAE,YAAY,EAAE,MAAM,WAAW,CAAC;AAGzC,MAAM,YAAY,GAAc;IAC9B,YAAY,EAAE,IAAI;IAClB,OAAO,EAAE,EAAE;IACX,kBAAkB,EAAE,EAAE;IACtB,MAAM,EAAE,CAAC;CACV,CAAC;AAEF,MAAM,CAAC,MAAM,OAAO,GAAG,aAAa,CAClC,YAAY,EACZ,EAAE,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IACpD,OAAO;QACL,GAAG,KAAK;QACR,OAAO,EAAE;YACP,GAAG,KAAK,CAAC,OAAO;YAChB,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,KAAK;SAClC;KACF,CAAC;AACJ,CAAC,CAAC,EACF,EAAE,CAAC,YAAY,CAAC,wBAAwB,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IAC3D,OAAO;QACL,GAAG,KAAK;QACR,kBAAkB,EAAE,OAAO,CAAC,KAAK,CAAC,MAAM,CACtC,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAC5C,EAAwB,CACzB;KACF,CAAC;AACJ,CAAC,CAAC,EACF,EAAE,CAAC,YAAY,CAAC,eAAe,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IAClD,OAAO;QACL,GAAG,KAAK;QACR,YAAY,EAAE,OAAO,CAAC,MAAM;KAC7B,CAAC;AACJ,CAAC,CAAC,EACF,EAAE,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IACjD,OAAO;QACL,GAAG,KAAK;QACR,OAAO,EAAE;YACP,GAAG,KAAK,CAAC,OAAO;YAChB,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;gBAChB,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC;gBAChC,QAAQ,EAAE;oBACR,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,QAAQ;oBACzC,OAAO,CAAC,OAAO;iBAChB;aACF;SACF;KACF,CAAC;AACJ,CAAC,CAAC,EACF,EAAE,CAAC,YAAY,CAAC,qBAAqB,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IACxD,OAAO;QACL,GAAG,KAAK;QACR,kBAAkB,EAAE;YAClB,GAAG,KAAK,CAAC,kBAAkB;YAC3B,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;gBAChB,GAAG,KAAK,CAAC,kBAAkB,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC3C,GAAG,OAAO,CAAC,OAAO;aACnB;SACF;KACF,CAAC;AACJ,CAAC,CAAC,EACF,EAAE,CAAC,YAAY,CAAC,kBAAkB,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IACrD,OAAO;QACL,GAAG,KAAK;QACR,kBAAkB,EAAE;YAClB,GAAG,KAAK,CAAC,kBAAkB;YAC3B,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,CAAC,OAAO;SAClC;KACF,CAAC;AACJ,CAAC,CAAC,EACF,EAAE,CAAC,YAAY,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;IAC5C,OAAO;QACL,GAAG,KAAK;QACR,MAAM,EAAE,OAAO,CAAC,MAAM;KACvB,CAAC;AACJ,CAAC,CAAC,CACH,CAAC","sourcesContent":["import { createReducer, on } from '@ngrx/store';\r\nimport { chatsActions } from './actions';\r\nimport { ChatState, LastMessageChatMap } from './store';\r\n\r\nconst initialState: ChatState = {\r\n  activeChatId: null,\r\n  chatMap: {},\r\n  lastMessageChatMap: {},\r\n  unread: 0,\r\n};\r\n\r\nexport const reducer = createReducer(\r\n  initialState,\r\n  on(chatsActions.loadedGetChatById, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      chatMap: {\r\n        ...state.chatMap,\r\n        [payload.chats.id]: payload.chats,\r\n      },\r\n    };\r\n  }),\r\n  on(chatsActions.loadedLastMessageChatMap, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      lastMessageChatMap: payload.chats.reduce(\r\n        (acc, item) => ({ ...acc, [item.id]: item }),\r\n        {} as LastMessageChatMap\r\n      ),\r\n    };\r\n  }),\r\n  on(chatsActions.setActiveChatId, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      activeChatId: payload.chatId,\r\n    };\r\n  }),\r\n  on(chatsActions.addMessageChat, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      chatMap: {\r\n        ...state.chatMap,\r\n        [payload.chatId]: {\r\n          ...state.chatMap[payload.chatId],\r\n          messages: [\r\n            ...state.chatMap[payload.chatId].messages,\r\n            payload.message,\r\n          ],\r\n        },\r\n      },\r\n    };\r\n  }),\r\n  on(chatsActions.upsertLastMessageChat, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      lastMessageChatMap: {\r\n        ...state.lastMessageChatMap,\r\n        [payload.chatId]: {\r\n          ...state.lastMessageChatMap[payload.chatId],\r\n          ...payload.message,\r\n        },\r\n      },\r\n    };\r\n  }),\r\n  on(chatsActions.addLastMessageChat, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      lastMessageChatMap: {\r\n        ...state.lastMessageChatMap,\r\n        [payload.chatId]: payload.message,\r\n      },\r\n    };\r\n  }),\r\n  on(chatsActions.setUnread, (state, payload) => {\r\n    return {\r\n      ...state,\r\n      unread: payload.unread,\r\n    };\r\n  })\r\n);\r\n"]}