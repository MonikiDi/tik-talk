{"version":3,"file":"profile-page.component.js","sourceRoot":"","sources":["../../../../../../../../profile/src/lib/feature-profile-page/profile-page/profile-page.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, Component, DestroyRef, inject, OnInit } from '@angular/core';\r\nimport { ProfileHeaderComponent } from '../../ui/profile-header/profile-header.component';\r\nimport { ActivatedRoute, Router, RouterLink } from '@angular/router';\r\nimport { map, Observable, of, switchMap } from 'rxjs';\r\nimport { AsyncPipe } from '@angular/common';\r\nimport { AboutMeComponent, SvgIconComponent, TasksComponent } from '@tt/common-ui';\r\nimport { SubscribersComponent } from '@tt/subscribers';\r\nimport { Store } from '@ngrx/store';\r\nimport { PostFeedComponent } from '@tt/posts';\r\nimport { postsActions, profileActions, selectPostsUserById, selectUser } from '@tt/data-access';\r\nimport { takeUntilDestroyed, toSignal } from '@angular/core/rxjs-interop';\r\nimport { Profile } from '@tt/interfaces/profile';\r\nimport { SubscriptionsComponent } from '@tt/subscriptions';\r\n\r\n@Component({\r\n  selector: 'app-profile-page',\r\n  standalone: true,\r\n  imports: [\r\n    ProfileHeaderComponent,\r\n    AsyncPipe,\r\n    AboutMeComponent,\r\n    PostFeedComponent,\r\n    SubscribersComponent,\r\n    TasksComponent,\r\n    SvgIconComponent,\r\n    RouterLink,\r\n    SubscriptionsComponent\r\n  ],\r\n  templateUrl: './profile-page.component.html',\r\n  styleUrl: './profile-page.component.scss',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ProfilePageComponent implements OnInit {\r\n  private readonly activatedRoute = inject(ActivatedRoute);\r\n  private destroyRef = inject(DestroyRef);\r\n  private readonly router = inject(Router);\r\n  private readonly store = inject(Store);\r\n  public profile$: Observable<Profile | undefined> =\r\n    this.store.select(selectUser);\r\n  public posts = toSignal(\r\n    this.activatedRoute.params.pipe(\r\n      switchMap((params) => {\r\n        return !params?.['id']\r\n          ? of(undefined)\r\n          : this.store.select(selectPostsUserById(params?.['id']));\r\n      })\r\n    )\r\n  );\r\n\r\n  ngOnInit() {\r\n    this.activatedRoute.params\r\n      .pipe(\r\n        map((params) => {\r\n          return params?.['id'];\r\n        }),\r\n        takeUntilDestroyed(this.destroyRef)\r\n      )\r\n      .subscribe((userId) => {\r\n        if (userId) {\r\n          this.store.dispatch(profileActions.loadUserId({ userId: userId }));\r\n          this.store.dispatch(postsActions.loadPostsUserId({ userId: userId }));\r\n        } else {\r\n          throw new Error('not fount user id');\r\n        }\r\n      });\r\n  }\r\n\r\n  async sendMessage(userId: number) {\r\n    this.router.navigate(['/chats', 'new'], { queryParams: { userId } });\r\n  }\r\n}\r\n"]}